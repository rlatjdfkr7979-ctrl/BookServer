<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>📚 울산도시공사 도서관리 시스템</title>
<style>
body{font-family:'Pretendard','Noto Sans KR',sans-serif;background:#f8fafc;margin:0;padding:25px;}
h1{text-align:center;color:#004080;margin-bottom:10px;}
nav{text-align:center;margin-bottom:25px;}
button{background:#004080;color:white;border:none;border-radius:8px;padding:10px 18px;margin:0 5px;cursor:pointer;font-size:15px;}
button.active{background:#2563eb;}
input{display:block;margin:15px auto 20px;padding:8px 15px;font-size:14px;border:1px solid #ccc;border-radius:6px;width:260px;}
table{width:100%;border-collapse:collapse;background:white;box-shadow:0 0 5px rgba(0,0,0,0.05);}
th,td{border:1px solid #e2e8f0;padding:7px 10px;text-align:left;font-size:13.5px;}
th{background:#f1f5f9;color:#004080;}
tr:nth-child(even){background:#fafafa;}
tr:hover{background:#eef6ff;}
footer{text-align:center;color:#666;font-size:13px;margin-top:30px;}
.hidden{display:none;}
</style>
</head>
<body>

<h1>📚 울산도시공사 도서관리 시스템</h1>
<nav>
  <button id="btnLoans" class="active">📘 대출 현황</button>
  <button id="btnLibrary">📗 전체 도서목록</button>
</nav>

<div id="loanSection">
  <input type="text" id="searchLoans" placeholder="도서명, 대여자, 코드번호 검색...">
  <table id="loanTable"></table>
</div>

<div id="librarySection" class="hidden">
  <input type="text" id="searchLibrary" placeholder="제목, 저자, 출판사 검색...">
  <table id="libraryTable"></table>
</div>

<footer>© 울산도시공사 도서관리 시스템 | CSV 기반 GitHub Pages 뷰어</footer>

<script>
// CSV 로드 함수
async function loadCSV(file, tableId){
  const res = await fetch(file+'?v='+Date.now()); // 캐시 방지
  if(!res.ok) throw new Error(file + ' 로드 실패');
  const text = await res.text();
  const rows = text.trim().split('\n').map(r => r.split(','));
  const header = rows.shift();
  const table = document.getElementById(tableId);
  table.innerHTML = '<tr>'+header.map(h=>`<th>${h}</th>`).join('')+'</tr>';
  for(const row of rows){
    const tr = document.createElement('tr');
    tr.innerHTML = row.map(c=>`<td>${c}</td>`).join('');
    table.appendChild(tr);
  }
}

// 검색 필터 함수
function addSearch(inputId, tableId){
  document.getElementById(inputId).addEventListener('input', e=>{
    const val = e.target.value.trim();
    const trs = document.querySelectorAll(`#${tableId} tr`);
    trs.forEach((tr,i)=>{
      if(i===0)return;
      tr.style.display = tr.innerText.includes(val)?'':'none';
    });
  });
}

// 탭 전환
document.getElementById('btnLoans').onclick = ()=>{
  document.getElementById('loanSection').classList.remove('hidden');
  document.getElementById('librarySection').classList.add('hidden');
  document.getElementById('btnLoans').classList.add('active');
  document.getElementById('btnLibrary').classList.remove('active');
};
document.getElementById('btnLibrary').onclick = ()=>{
  document.getElementById('librarySection').classList.remove('hidden');
  document.getElementById('loanSection').classList.add('hidden');
  document.getElementById('btnLibrary').classList.add('active');
  document.getElementById('btnLoans').classList.remove('active');
};

// 실행
loadCSV('books.csv','loanTable');
loadCSV('library.csv','libraryTable');
addSearch('searchLoans','loanTable');
addSearch('searchLibrary','libraryTable');
</script>
</body>
</html>
